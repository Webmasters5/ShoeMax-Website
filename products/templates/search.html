{% extends "base/nav.html" %}
{% load static %}

{% block title %}Search Shoes - ShoeMax{% endblock %}

{% block extra_head %}
	<meta name="description" content="Search for shoes by name, category, and price range.">
	<link rel="stylesheet" href="{% static 'css/search.css' %}">
{% endblock %}

{% block content %}
<div class="search-page">
	<h1 class="page-title">Find Your Perfect Pair</h1>

	<form method="get" class="filters">
		<div class="field">
			<label for="q">Search</label>
			<input type="text" name="q" id="q" value="{{ q }}" placeholder="Search shoes..." />
		</div>

		<div class="field">
			<label for="category">Category</label>
			<select name="category" id="category">
				<option value="">All categories</option>
				{% for cat in categories %}
					<option value="{{ cat }}" {% if cat == selected_category %}selected{% endif %}>{{ cat }}</option>
				{% endfor %}
			</select>
		</div>

		<div class="field inline">
			<label>Price</label>
			<input type="number" name="min_price" step="0.01" min="0" value="{{ min_price }}" placeholder="Min" />
			<span class="dash">â€”</span>
			<input type="number" name="max_price" step="0.01" min="0" value="{{ max_price }}" placeholder="Max" />
		</div>

		<div class="actions">
			<button type="submit" class="btn primary">Search</button>
			<a href="?" class="btn">Reset</a>
		</div>
	</form>

	<div class="results-meta">
		{% if shoes %}
			<strong>{{ shoes|length }}</strong> result{{ shoes|length|pluralize }} found
		{% else %}
			No results found
		{% endif %}
	</div>

	<ul class="results">
		{% for shoe in shoes %}
			<li class="card">
				<a href="{% url 'products:shoe_details' shoe.shoe_id %}" class="card-link">
					<div class="thumb">
						{% if shoe.image_url %}
							<img src="{{ shoe.image_url.url }}" alt="{{ shoe.name }}">
						{% else %}
							<img src="{% static 'images/image1.png' %}" alt="{{ shoe.name }}">
						{% endif %}
					</div>
					<div class="info">
						<h3 class="name">{{ shoe.name }}</h3>
						<div class="meta">
							<span class="category">{{ shoe.category }}</span>
							<span class="price">${{ shoe.price }}</span>
						</div>
						<p class="desc">{{ shoe.description|truncatewords:20 }}</p>
					</div>
				</a>
			</li>
		{% empty %}
			<li class="empty">Try adjusting your filters.</li>
		{% endfor %}
	</ul>
</div>
{% endblock %}
