{% extends "customer/base.html" %}

{% block dashboard_content %}
<h1>Order #{{ order.order_id }}</h1>

<!-- Order Details -->
<div class="profile-card light-card hover-pop">
    <h2>Order Details</h2>
    <p><strong>Date:</strong> {{ order.order_date }}</p>
    <p><strong>Status:</strong> {{ order.status }}</p>
</div>

<!-- Customer Info -->
<div class="profile-card light-card hover-pop">
    <h2>Customer Info</h2>
    <p><strong>Name:</strong> {{ order.customer.user.first_name }} {{ order.customer.user.last_name }}</p>
    <p><strong>Shipping Address:</strong> {{ order.shipping_address }}</p>
    <p><strong>Billing Address:</strong> {{ order.billing_address }}</p>
</div>

<!-- Order Items -->
<div class="profile-card light-card hover-pop">
    <h2>Order Items</h2>
    <table>
        <thead>
            <tr>
                <th>Product</th>
                <th>Quantity</th>
                <th>Unit Price</th>
                <th>Subtotal</th>
            </tr>
        </thead>
        <tbody>
            {% for item in order.items.all %}
            <tr>
                <td>
                    <div style="display:flex; align-items:center; gap:12px;">
                        {% with item.variant.shoe.images.first as first_image %}
                            {% if first_image %}
                                <img src="{{ first_image.image.url }}" alt="{{ first_image.alt_text|default:item.variant.shoe.name }}" style="width:80px; height:80px; object-fit:cover; border-radius:4px;"/>
                            {% else %}
                                <div style="width:80px; height:80px; background:#f0f0f0; display:flex; align-items:center; justify-content:center; color:#888; font-size:12px; border-radius:4px;">No image</div>
                            {% endif %}
                        {% endwith %}
                        <div>
                            <div style="font-weight:600;">{{ item.variant.shoe.brand.name }} &mdash; {{ item.variant.shoe.name }}</div>
                            <div style="color:#555; font-size:0.95rem;">Color: {{ item.variant.color }} | Size: {{ item.variant.size }}</div>
                        </div>
                    </div>
                </td>
                <td style="text-align:center;">{{ item.quantity }}</td>
                <td>${{ item.price }}</td>
                <td>${{ item.subtotal }}</td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <td colspan="3" style="text-align:right;"><strong>Total:</strong></td>
                <td><strong>${{ order.total_price }}</strong></td>
            </tr>
        </tfoot>
    </table>
</div>

<!-- Payment Info -->
<div class="profile-card light-card hover-pop">
    <h2>Payment Info</h2>
    <p>Card ending in: {{ order.customer.credit_card|slice:"-4:" }}</p>
</div>

<a href="{% url 'customer:customer_orders' %}" class="btn btn-dashboard mt-3">Back to Orders</a>

<style>
/* Light grey cards with hover pop-out */
.profile-card,
.dashboard-card,
.light-card {
    background-color: #f9f9f9 !important;
    border-radius: 12px !important;
    padding: 25px !important;
    margin-bottom: 20px !important;
    border: 1px solid #e0e0e0 !important;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05) !important;
    transition: transform 0.25s ease, box-shadow 0.25s ease !important;
}

.profile-card:hover,
.dashboard-card:hover,
.light-card:hover {
    transform: translateY(-4px) !important;
    box-shadow: 0 8px 20px rgba(0,0,0,0.08) !important;
}

/* Order table styling */
table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
}

table th, table td {
    border: 1px solid #ddd;
    padding: 8px;
}

table th {
    background-color: #f5f5f5;
    text-align: left;
}

table td {
    vertical-align: middle;
}
</style>

{% endblock %}
