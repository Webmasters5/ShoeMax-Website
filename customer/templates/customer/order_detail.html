{% extends "customer/base.html" %}

{% block content %}
<h1>Order #{{ order.order_id }}</h1>
<p><strong>Date:</strong> {{ order.order_date }}</p>
<p><strong>Status:</strong> {{ order.status }}</p>

<div class="profile-section">
    <h2>Customer Info</h2>
    <p><strong>Name:</strong> {{ order.customer.user.first_name }} {{ order.customer.user.last_name }}</p>
    <p><strong>Shipping Address:</strong>
        {% if order.shipping_address %}
            {{ order.shipping_address.first_name }} {{ order.shipping_address.last_name }}, {{ order.shipping_address.street }}, {{ order.shipping_address.city }} {{ order.shipping_address.zip_code }}
        {% else %}
            N/A
        {% endif %}
    </p>
    <p><strong>Billing Address:</strong>
        {% if order.billing_address %}
            {{ order.billing_address.first_name }} {{ order.billing_address.last_name }}, {{ order.billing_address.street }}, {{ order.billing_address.city }} {{ order.billing_address.zip_code }}
        {% else %}
            N/A
        {% endif %}
    </p>
</div>

<div class="profile-section">
    <h2>Order Items</h2>
    <table style="width:100%; border-collapse: collapse;">
        <thead>
            <tr>
                <th style="border-bottom: 1px solid #ddd; padding: 8px;">Product</th>
                <th style="border-bottom: 1px solid #ddd; padding: 8px;">Quantity</th>
                <th style="border-bottom: 1px solid #ddd; padding: 8px;">Unit Price</th>
                <th style="border-bottom: 1px solid #ddd; padding: 8px;">Subtotal</th>
            </tr>
        </thead>
        <tbody>
            {% for item in order.items.all %}
            <tr>
                <td style="padding: 8px;">
                    <div style="display:flex; align-items:center; gap:12px;">
                        {% with item.variant.shoe.images.first as first_image %}
                            {% if first_image %}
                                <img src="{{ first_image.image.url }}" alt="{{ first_image.alt_text|default:item.variant.shoe.name }}" style="width:80px; height:80px; object-fit:cover; border-radius:4px;"/>
                            {% else %}
                                <div style="width:80px; height:80px; background:#f0f0f0; display:flex; align-items:center; justify-content:center; color:#888; font-size:12px; border-radius:4px;">No image</div>
                            {% endif %}
                        {% endwith %}
                        <div>
                            <div style="font-weight:600;">{{ item.variant.shoe.brand.name }} &mdash; {{ item.variant.shoe.name }}</div>
                            <div style="color:#555; font-size:0.95rem;">Color: {{ item.variant.color }} &nbsp;|&nbsp; Size: {{ item.variant.size }}</div>
                        </div>
                    </div>
                </td>
                <td style="padding: 8px; text-align: center;">{{ item.quantity }}</td>
                <td style="padding: 8px;">${{ item.price }}</td>
                <td style="padding: 8px;">${{ item.subtotal }}</td>
            </tr>
            {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <td colspan="3" style="text-align: right; padding: 8px;"><strong>Total:</strong></td>
                <td style="padding: 8px;"><strong>${{ order.total_price }}</strong></td>
            </tr>
        </tfoot>
    </table>
</div>

<div class="profile-section">
    <h2>Payment Info</h2>
    <p> {{order.payment_method_label}}    </p>
</div>

<a href="{% url 'customer:customer_orders' %}" class="btn">Back to Orders</a>

{% endblock %}
